# Gambling Soft

## Установка Покера.
1. Создайте новую папку для проекта, имя папки должно быть `poker2`.
2. Запустите `git clone git@github.com:GamblingSoft/poker.git ./` внутри `poker2`.
3. Выйдите из директории `poker2`.
4. Установите проект laradock по этой инструкции https://laradock.io/getting-started/ используйте установку для нескольких проектов.
5. Папка `laradock` должна находиться на том же уровне что и `poker2`.
6. Обновите `MYSQL_VERSION=8.0` в `laradock/.env`.
7. Обновите `PHP_VERSION=8.2` в `laradock/.env`.
8. Только для `Mac с M1` процессорами, убедитесь что установлена настройка `APACHE_FOR_MAC_M1=true` в `laradock/.env`.
9. Запустите `docker compose up -d mysql apache2` из папки `laradock`.
10. Подождите пока соберутся необходимые контейнеры с настройкой по умолчанию для apache2 и mysql.
11. Скопируйте `.env.dist` в `.env`.
12. Создайте базу данных `poker`.
13. Запустить `composer install` внутри папки `poker2` из контейнера или глобально.
14. Запустите миграции `php bin/console doctrine:migrations:migrate`.
15. Скопируйте `public/engine/mini_example.php` в `public/engine/mini.php`, это заглушка для основных классов ядра.
16. Запустите `php bin/console importmap:install`.

### Troubleshootings: 
1. По желанию можно добавить домен:
 - Linux/Mac: 
    * `etc/hosts` -> добавьте эту строчку `127.0.0.1 {domain_name}`, где {domain_name} это ваш локальный домен для доступа в браузере.
 - Windows:
    * `c:\Windows\System32\Drivers\etc\hosts` -> добавьте эту строчку `127.0.0.1 {domain_name}`, где {domain_name} это ваш локальный домен для доступа в браузере..
    * Для изменения `hosts` в Windows, необходимо открыть блокнот с правами администратора, после обновить и сохранить `hosts`.

2. При ошибках mysql контейнера `DATA_PATH_HOST=~/.laradock/` в `laradock/.env`.
3. Убедитесь что `VPN отключен`.

## Правила Разработки.

### Основной подход:
1. Перейти на ветку `develop` - `git checkout develop`.
2. Создать новую ветку `git checkout -b {new_branch}`.
3. Внести изменения.
4. Сделать коммит `git commit -m "{comment}"`.
5. Залить изменения в удаленную ветку `git push origin {new_branch}`.
6. Создать merge request в ветку `develop`, запросить проверку у команды и лида.
7. После утверждения изменений, слить merge request.

### Branches:
* `main` - Основная ветка которая используется для хранения последних стабильных изменений. В нее запрещается делать коммиты и пуши без пул реквестов.
* `develop` - Ветка для разработки. Ветка со всеми актуальными изменениями.

Для того чтоб начать разработку функционала или исправления ошибок, необходимо создать локально создать ветку в соответсвии с номером задачи и ее названием, по шаблону:
- Новый функционал - `{task_number}-{task_name}`
- Исправление ошибки - `{task_number}-{task_name}`

**Название веток должны быть на Английском языке.**

Пример cоздания новой ветки:
- `git checkout -b gs-1072-github-settings`
- `git checkout -b gs-1058-fix-frontend-template`

Если имя задачи очень длинное, старайтесь сократить его, так чтоб основной смысл отображался в названии ветки.

### Commits:

После завершения разработки, необходимо закомитить изменения в ветку в которой вы работали.
Сообщение коммита должно содержать основную информацию ваших изменения, постарайтесь обозначить ключевые моменты.
Текже каждое сообщение коммита, должно содержать номер задачи, это важно для истории.
**Сообщения коммитов должны быть на Английском языке.**

Пример:
- `git commit -m "gs-1075: Create User Controller, fix bug related to registration."`
- `git commit -m "gs-1287: Adjust auth action with promo activation, update global configuration."`

### Push:

#### !!! Запрещается пушить и комитить напрямую в ветки `develop` и `main`, только в исключительных случаях при согласии команды и руководителей.
#### !!! Не рекомендуется использовать `git rebase`, `git push -f`, `git push --force`.

Рекомендуется делать пуш каждый день, после завершения рабочего дня. Это необходимо для того чтоб любой другой разработчик, смог продолжить вашу разарботку в случае,
вашего отсутсвия по какой-либо причине.

Пример:
- `git push origin 1065-{branch_name}`

### Merge Request:

После завершения работы над задачей, необходимо создать `merge request` в ветку `develop` и запросить проверку вашего кода у команды.
В случае успешного прохождения проверки, ваш код будет добавлен в ветку `develop` и отправлен на тестовый сервер, где вы сможете проверить свои изменения.
Если ваш код нуждается в доработке, в таком случае необходимо внести исправления и после запросить проверку еще раз, у тех же сотрудников, которые оставили
коментарии в `merge request` в первый раз.

Рекомендуется добиться 2 подтверждения от своей команды(одно из них должно быть от лидера команды), для изменений в `merge request`.

Слияние вашей ветки и ветки `develop`, могут производить луюбые учасники команды при наличии 2 подтверждений.

## Форматирование кода:

Для удобства оформления кода в единой стилистике, была добавлена библиотека `php-cs-fixer` которая позволяет настроить единую конфигурацию для оформления кода.

### !!! Рекомендуется запускать `php-cs-fixer` после того как запушили изменения, сниффер запускать только для файлов которые учавствуют в ветке.

Пример запуска снифера OS Windows: 
 - `{Path_to_PHP.exe} php-cs-fixer.phar fix`

Пример запуска снифера OS Linux:
 - `php php-cs-fixer.phar fix`

Документация к сниферу: https://github.com/PHP-CS-Fixer/PHP-CS-Fixer/blob/master/doc/usage.rst
